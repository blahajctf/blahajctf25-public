
from Crypto.Util.number import getPrime, bytes_to_long
import random

m = bytes_to_long(random.randbytes(64))

p = int(getPrime(513)) # int(input("Enter your prime number!\n>> "))
assert p > m

q = getPrime(512)
r = getPrime(512)
n = p*q*r
e = 65537
c = pow(m, e, n)
print("c =", c)
print("n =", n)

d = pow(e, -1, p-1)
_m = pow(c, d, p) # int(input("Enter secret\n>> "))
print(_m == m)

"""
> ncat 127.0.0.1 1337
Enter your prime number!
>> 19846051874469223214492336801536637459957938004030256922485139412745466986662762762685216997403387070757487228261618429535676755040958076512382319089805033
c = 506947406793364511883443672584838047640814888948340725413452570691793566147350929140643608577286359555978012026811146005113077515809147054350952518991577944142252521054027820361032913341819773453889749099773577550131789498663188424896327652740892838073445052408099809409302350360490537086865025915897240511638324569785613072386142805930484171272267642155285009872370194221571993631318584156230520404369490778665009484591475136841958360981648373159987612837730889
n = 2367459367632360224933909725289838526043217601477620440560827723786706040344982163880551132591019770224068722899812009743354915682076455004300172568609201918441397375671954469179161209820842738275521529184841800793414746852766770953814226314687737950220066776089292015745261501770264277371238170096543353147654522212830936795790862265318839724165507577400757508554144016564883570554797390673291828601184965767683713392816027850490795325904996607735116010840459073
Enter secret
>> 9591177947537387389150574659516195232348419882685837721936688568369833337377026420667789306201335251942195626995875091489865874351745599602920863572111826
blahaj{meanwhile-there-was-that-other-one-in-2024_LNC...}
"""